<title>菜单管理列表</title>
<css>
	<link rel="stylesheet" type="text/css" href="${ctx}/themes/default/static/AdminLTE-2.3.8/plugins/bootstrap-tree/bootstrap-treeview.main.css">
</css>
<section class="content">
	<div class="row">
		<table class="table table-striped table-hover">
			<thead>
			<tr>
				<th>id</th>
				<th>name</th>
				<th>key</th>
				<th>description</th>
				<th>创建时间</th>
				<th>版本</th>
				<th>操作</th>
			</tr>
			</thead>
			<tbody>
			<#if models??&models?size gt 0>
				<#list models as model>
					<tr>
						<th>${model.id!''}</th>
						<th>${model.name!''}</th>
						<th>${model.key!''}</th>
						<th>${model.category!''}</th>
						<th>${model.createTime?string('yyyy.MM.dd: HH:mm:ss')!''}</th>
						<th>${model.version!''}</th>
						<th>
							<a class="deploy" >部署</a>
							<a href="${ctx}/themes/default/modeler/modeler.html?modelId=${model.id}" target="_blank">编辑</a>
						</th>
					</tr>
				</#list>
				<#else/>
				<tr>
					<th colspan="7"><label>没有查询到model<a href="${ctx}/modeler/create">去创建model</a> </label></th>
				</tr>
			</#if>
			</tbody>
		</table>
	</div>
</section>
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
				<h4 class="modal-title" id="myModalLabel">选择组</h4>
			</div>
			<div class="modal-body">
				<form id="relationshipForm" method="post" class="form-horizontal" role="form" action="${ctx}/user/manager/relationship">
					<input type="hidden" name="userId" id="userIdAttr">
					<select class="form-control" name="groupId">
						<#if groups??&&groups?size gt 0>
							<#list groups as group>
								<option value="${group.id}">${group.name}</option>
							</#list>
							<#else/>
							<option>---</option>
						</#if>
					</select>
					<button id="relationshipSubmit" type="button" class="btn btn-primary" onclick="submit()">Save changes</button>
				</form>
			</div>
			<div class="modal-footer">
				<button type="submit" class="btn btn-default" data-dismiss="modal">Close</button>
			</div>
		</div>
	</div>
</div>
<js>
	<Script>
		function getTree() {
			// Some logic to retrieve, or generate tree structure
			return data;
		}
		$('#tree').treeview({data: getTree()});

	$(".deploy").click(function () {
		var id = $(this).parent().parent().find("th").eq(0).html();
		$.get("${ctx}/modeler/deploy",{modelId:id},
				function (data) {
					alert(data.message);
				}
		)
	})
	</script>
</js>
