<title>任务列表</title>
<section class="content">
	<div class="row">
		<table class="table table-bordered table-striped table-hover table-condensed">
			<thead>
			<tr>
				<th>任务名称</th>
				<th>任务开始时间</th>
				<th>流程版本号</th>
				<th>操作</th>
			</tr>
			</thead>
			<tbody>
			<#if tasks??&&tasks?size gt 0>
				<#list tasks as task>
					<tr>
						<td>${task.name!''}</td>
						<td>${task.createTime?string('yyyy-MM-dd HH:mm:ss')!''}</td>
						<td>${task.revision!''}</td>
						<td>
							<#if task.assignee??>
								<a class="doTask option" href="${ctx}/task/doTask/${task.id}">办理</a>
								<#else/>
								<a class="claimTask option" href="#" onclick="claim('${task.id}')">签收</a>
								<js>
									<script type="text/javascript">
										function claim(obj) {
											$.ajax({
												type:"POST",
												url:"${ctx}/task/claim/"+obj,
												dataType:"json",
												success : function(data) {
													if(data.state == 1){
														alert(data.message);
													}else{
														refresh();
														alert(data.message);
													}
												},
												error : function(data) {
													alert(data.message);
												}
											})
										}
									</script>
								</js>
							</#if>
						</td>
					</tr>
				</#list>
				<#else/>
				<tr>
					<td colspan="7"><label>没有查询到任务</label></td>
				</tr>
			</#if>
			</tbody>
			<tfoot>
			<tr>
				<td colspan="6">
					<nav aria-label="...">
						<ul class="pagination">
							<li class="disabled"><a href="#" aria-label="Previous"><span aria-hidden="true">«</span></a></li>
							<li class="active"><a href="#">1 <span class="sr-only">(current)</span></a></li>
							<li><a href="#">2</a></li>
							<li><a href="#">3</a></li>
							<li><a href="#">4</a></li>
							<li><a href="#">5</a></li>
							<li><a href="#" aria-label="Next"><span aria-hidden="true">»</span></a></li>
						</ul>
					</nav>
				</td>
			</tr>
			</tfoot>
		</table>
	</div>
</section>
